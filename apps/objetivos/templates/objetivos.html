{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>U-Balance - Objetivos</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="{% static 'core/css/style_dashboard.css' %}" />
  <link rel="stylesheet" href="{% static 'objetivos/css/objetivos.css' %}" />
</head>
<body>
  <aside class="sidebar">
    <h1>U-Balance</h1>
    <nav>
      <a href="{% url 'core:dashboard' %}">🏠 Início</a>
      <a href="#" id="abrirModalTransacao">💲 Adicionar Transação</a>
      <a href="#" id="abrirModalMeta">🎯 Adicionar Meta</a>
      <a href="#" id="abrirModalObjetivo">📈 Adicionar Objetivo</a>
      <a href="{% url 'core:metas:meta' %}">🎯 Metas</a>
      <a href="{% url 'core:objetivos:menu_objetivos' %}" style="background-color: #f0f0f0; font-weight: 600;">📈 Objetivos</a>
      <a href="#">🧾 Extrato</a>
      <a href="#">📊 Relatórios</a>
      <a href="#">⚙️ Configurações</a>
      <a href="{% url 'usuario:logout' %}" id="logout">Logout</a>
    </nav>
  </aside>

  <main class="content">
    <div class="objetivos-header">
      <h1>Objetivos</h1>
      <div class="usuario-info">Usuário: {{ usuario.nome }}</div>
    </div>
    <div class="objetivos-grid">
      {% for objetivo in objetivos %}
      <div class="objetivo-card">
        <div class="objetivo-header">
          <div class="objetivo-status status-{{ objetivo.status_formatado|lower|slugify }}">
            {{ objetivo.status_formatado }}
          </div>
        </div>
        <div class="objetivo-content">
          <h3 class="objetivo-titulo">{{ objetivo.titulo }}</h3>

          <div class="objetivo-valores">
            <div class="valor-item">
              <span class="valor-label">Valor guardado</span>
              <span class="valor-amount valor-guardado">R$ {{ objetivo.valor_guardado|floatformat:2 }}</span>
            </div>
            <div class="valor-item">
              <span class="valor-label">Valor objetivo</span>
              <span class="valor-amount valor-objetivo">R$ {{ objetivo.valor_objetivo|floatformat:2 }}</span>
            </div>
            <div class="valor-item">
              <span class="valor-label">Data limite</span>
              <span class="valor-amount valor-data">{{ objetivo.data_fim|date:"d/m/Y" }}</span>
            </div>
          </div>

          <div class="objetivo-progresso">
            <div class="progresso-info">
              <span class="progresso-label">Progresso</span>
              <span class="progresso-percentage">{{ objetivo.porcentagem }}%</span>
            </div>
            <div class="progresso-bar">
              <div class="progresso-fill {% if objetivo.porcentagem > 60 %}progresso-bom{% endif %}"
                   style="width: {{ objetivo.porcentagem|floatformat:0 }}%;">
              </div>
            </div>
            <div class="progresso-detalhes">
              <span>Faltam R$ {{ objetivo.valor_faltante|floatformat:2 }} para atingir o objetivo</span>
            </div>
          </div>
        </div>
        <a href="{% url 'core:objetivos:detalhe_objetivo' objetivo.id %}" class="btn-ver-mais">
           Ver Detalhes
        </a>
      </div>
      {% endfor %}
    </div>
  </main>
  <script>
    document.getElementById('logout').addEventListener('click', function(e) {
      e.preventDefault();
      if(confirm('Tem certeza que deseja sair?')) {
        window.location.href = '{% url "usuario:logout" %}';
      }
    });
  </script>
</body>
</html>